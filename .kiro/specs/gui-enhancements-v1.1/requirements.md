# 要求仕様書

## 概要
本機能は、Python初学者向けローグライク演習フレームワークのv1.1における主要なGUI改善を実装します。現在のv1.0.1では実行が瞬時に完了し学習者が動作を確認できない問題があるため、ステップ実行機能、実行制御UI、main.py構造の改善、アクション履歴表示、セッションログ機能の整備を行い、学習効果を大幅に向上させます。

## 要求事項

### 要求事項1: GUI実行制御機能
**ユーザーストーリー:** 学習者として、solve()内の動作を段階的に確認したいので、ステップ実行や一時停止ができる実行制御機能が欲しい

#### 受け入れ基準
1. WHEN main.pyを実行した時 THEN システムはsolve()実行直前で自動的に停止しなければならない
2. WHEN ステップ実行ボタンが押された時 THEN システムはAPIレイヤー関数（turn_right等）を1回実行して一時停止しなければならない  
3. WHEN まとめて実行ボタンが押された時 THEN システムはsolve()内を継続実行し、各アクション操作後に設定されたsleep時間で一時停止しなければならない
4. WHEN ストップボタンが押された時 THEN システムは次のアクション操作実行後に一時停止しなければならない
5. WHEN solve()の実行が完了した時 THEN システムは実行完了メッセージを表示して一時停止しなければならない
6. WHERE アニメーション速度設定で THEN システムは1秒、0.5秒、0.25秒、0.125秒、0.0625秒のsleep時間から選択可能でなければならない

### 要求事項2: main.py構造改善
**ユーザーストーリー:** 学習者として、ステージ設定や学生IDを分かりやすく設定したいので、main.pyの構造を改善してハイパーパラメータを明確化したい

#### 受け入れ基準
1. WHERE solve()関数直前で THEN システムはハイパーパラメータ設定セクションを提供しなければならない
2. WHEN ステージ設定パラメータが未設定の時 THEN システムはデフォルトで"stage01"を設定しなければならない
3. WHEN 学生IDがNoneまたは未設定の時 THEN システムはエラーメッセージを表示して終了しなければならない
4. WHEN solve()関数が呼び出される前に THEN システムは「ステージ初期化」と「凡例と初期状態表示」を別関数で実行しなければならない
5. WHEN solve()関数内では THEN システムはキャラクタ操作のみを含む実装でなければならない
6. WHEN solve()関数の実行が完了した時 THEN システムは「結果表示」を別関数で実行しなければならない

### 要求事項3: アクション履歴機能
**ユーザーストーリー:** 学習者として、実行したアクションの履歴を確認したいので、ターミナルに実行順序付きでアクション操作を表示したい

#### 受け入れ基準
1. WHEN turn_right、move、attack等のAPIレイヤー関数が実行された時 THEN システムは実行順序番号とアクション名をターミナルに出力しなければならない
2. WHERE アクション履歴の出力形式で THEN システムは「N: function_name()」の形式（例：「1: turn_right()」）で表示しなければならない
3. WHILE solve()関数が実行中の間 THEN システムは各アクション実行の都度、連番でアクション履歴を蓄積しなければならない
4. WHEN 新しいゲームセッションが開始された時 THEN システムはアクション履歴のカウンターをリセットしなければならない

### 要求事項4: セッションログ機能
**ユーザーストーリー:** 学習者と教員として、学習プロセスを記録・確認したいので、セッションログの生成と参照方法を明確化したい

#### 受け入れ基準
1. WHEN main.pyがデフォルト実行される時 THEN システムは既存のログ生成機能を自動実行してセッションログを生成しなければならない
2. IF 現在ログ生成されていない場合 THEN システムは実装済みのログ機能をデフォルト有効化しなければならない
3. WHEN ログファイルが生成される時 THEN システムは生成されたログファイルの場所をユーザーに通知しなければならない
4. WHERE ログファイル参照方法で THEN システムはログの確認・表示方法を提供しなければならない
5. WHEN 学習セッションが完了した時 THEN システムはセッション結果をログファイルに記録しなければならない

## 非機能要求

### パフォーマンス要求
- システムはアクション操作の実行を100ms以内で処理しなければならない
- GUIの応答性を維持し、ボタン操作は即座に反映されなければならない

### ユーザビリティ要求
- 実行制御ボタンは直感的で分かりやすい配置でなければならない
- エラーメッセージは初学者に理解しやすい日本語で表示されなければならない

### 互換性要求
- 現在のv1.0.1のAPI互換性を維持しなければならない
- 既存のsteageファイルとテスト環境は変更なしで動作しなければならない