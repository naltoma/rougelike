id: stage11
title: ループ+攻撃練習ステージ
description: ループ処理と攻撃を組み合わせて学ぶステージです。プレイヤーは北向きで開始し、右上と右下の敵を倒してから左下のゴールを目指します。道中のアイテムも全て適切に扱いながらクリアを目指してください。

board:
  size: [10, 10]
  grid:
    - ".........."
    - "#########."
    - "#.......#."
    - "#.......#."
    - "#.......#."
    - "#.......#."
    - "#.......#."
    - "#.......#."
    - "#.......#."
    - ".........."
  legend:
    "#": "wall"
    ".": "empty"
    "P": "player"
    "G": "goal"
    "E": "enemy"

player:
  start: [0, 0]
  direction: "N"
  hp: 100
  max_hp: 100
  attack_power: 10

goal:
  position: [0, 9]

enemies:
  - id: "enemy1"
    position: [9, 0]    # 右上
    type: "normal"
    direction: "S"       # 南向き（プレイヤーが来ない方向）
    hp: 100
    max_hp: 100
    attack_power: 10
    vision_range: 2
    behavior: "static"
  - id: "enemy2"
    position: [9, 9]    # 右下
    type: "normal"
    direction: "W"       # 西向き（プレイヤーが来ない方向）
    hp: 350
    max_hp: 350
    attack_power: 10
    vision_range: 2
    behavior: "static"

items:
  - id: "bomb1"
    type: "bomb"
    name: "爆弾"
    position: [1, 0]
    description: Dangerous explosive device - dispose safely!
    damage: 20
  - id: key_1
    type: key
    position: [2, 0]
    name: 古い鍵
    description: A valuable key to collect
    value: 26
  - id: "potion_1"
    type: "potion"
    name: "回復薬"
    position: [9, 1]
    description: A valuable potion to collect
    value: 50
  - id: "sword1"
    type: "weapon"
    name: "鋼の剣"
    position: [9, 2]
    effect:
      attack: 35
    auto_equip: true


constraints:
  max_turns: 100
  allowed_apis: ["turn_left", "turn_right", "move", "attack", "wait", "see", "is_available", "pickup", "dispose"]

victory_conditions:
  - type: "defeat_all_enemies"
  - type: "reach_goal"
  - type: collect_all_items

# 学習目標とヒント
learning_objectives:
  - "for文を使った繰り返し処理を学ぶ"
  - "while文による条件付きループを理解する"
  - "攻撃処理とループの組み合わせを習得"
  - "敵を倒すための攻撃回数計算を学ぶ"
  - "移動、攻撃、ループの統合パターンを体験"

hints:
  - "プレイヤーは[0,0]から北向き(N)で開始し、左下[0,9]がゴールです"
  - "右上[9,0]と右下[9,9]に敵がいます。すべての敵を倒してからゴールに向かってください"
  - "全てのアイテムは適切に使用してください。爆弾は処理し、それ以外は取得する必要があります"
