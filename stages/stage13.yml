id: stage13
title: 大型敵2x2基本ステージ
description: 2x2サイズの大型敵と初めて戦うステージです。大型敵の移動パターンと怒り状態を観察し、基本的な戦略を学びましょう。

board:
  size: [10, 8]
  grid:
    - ".........."
    - ".........."
    - "....##...."
    - "....##...."
    - ".........."
    - ".........."
    - ".........."
    - ".........."
  legend:
    "#": "wall"
    ".": "empty"
    "P": "player"
    "G": "goal"
    "L": "large_enemy"
    "W": "weapon"

player:
  start: [0, 0]
  direction: "E"
  hp: 100
  max_hp: 100
  attack_power: 20

goal:
  position: [9, 7]

enemies:
  - id: "large_guardian"
    type: "large_2x2"
    position: [6, 2]  # 2x2敵なので右下座標
    direction: "W"
    hp: 1000  # プレイヤー攻撃力20×50回=1000
    max_hp: 1000
    attack_power: 1000  # 怒りモード時の即死攻撃
    rage_threshold: 0.5  # HP50%で怒りモード
    area_attack_range: 1  # 範囲1マス攻撃
    behavior: "stage11_special"  # ステージ11専用行動パターン
    stage11_special: true  # ステージ11専用の特別設定

items: []

constraints:
  max_turns: 300
  allowed_apis: ["turn_left", "turn_right", "move", "attack", "pickup", "wait", "see"]

victory_conditions:
  - type: "defeat_all_enemies"
  - type: "reach_goal"

# 学習目標とヒント
learning_objectives:
  - "2x2大型敵のサイズと占有範囲を理解する"
  - "平常時は無害（視野無視、攻撃無視）、HP50%下回ると怒りモード（挙動変更）になる仕組みを学ぶ"
  - "怒りモード時の範囲即死攻撃を回避する戦略を習得する"
  - "see()による大型敵の状態確認方法を学習する"

hints:
  - "プレイヤーは左上角[0,0]から開始、ゴールは右下角[9,7]です"
  - "2x2大型敵は中央[6,2]に配置されています（左上座標が基準）"
  - "プレイヤーの基本攻撃力は20です"
  - "大型敵のHP1000を攻撃力20で倒すには50回攻撃が必要です"
  - ""
  - "🤖 敵の動作解説:"
  - "  【平常時】HP50%以上では完全に無害 - 移動せず、攻撃せず、追跡しません"
  - "  【怒りモード突入】HP50%を下回り、かつ攻撃を受けた瞬間に発動"
  - "  【3ターン警告】怒りモード突入後、3ターンのカウントダウンを開始"
  - "  【範囲攻撃実行】4ターン目に周囲1マス範囲で即死攻撃を実行"
  - "  【平常復帰】範囲攻撃後は即座に平常時に戻る（再攻撃まで無害）"
  - ""
  - "⚠️ 戦略のポイント:"
  - "see()で大型敵の状態を確認して、HP500に近づいたら距離を取りましょう"
  - "info = see() として視界情報を取得できます。seeの戻り値は複雑な辞書型です。詳細は docs/see_descriptoion.md を参照ください。"
  - "infoから front_enemy = info['surroundings']['front'] とすることでプレイヤー真正面にいる敵情報を参照することができます。"
  - "前方敵の情報例として、front_enemy['hp'] にHP、front_enemy['alerted'] に怒りモードかどうかが保存されています。"
  - "怒りモード時は「turn_left() → turn_left() → move()」で3ターンかけて回避"
  - "範囲攻撃後は再び無害になるので、安全に再接近できます"
  - "戦略例: 敵HPが50%下回るまで攻撃→{回避→再接近→攻撃}を繰り返し、撃破"
  - "敵を倒したかどうかは front_enemy['type'] == 'enemy' で確認できます"